//=============================================================================
//【 JointBase 】
//=============================================================================

//-------------------------------------------------------------------------
//
//-------------------------------------------------------------------------
#include "stdafx.h"
#include "JointBase.h"

//-------------------------------------------------------------------------
//
//-------------------------------------------------------------------------
namespace LNote
{
namespace Core
{
namespace Physics
{

//=============================================================================
// ■ JointBase クラス
//=============================================================================

    //---------------------------------------------------------------------
	// ● コンストラクタ
    //---------------------------------------------------------------------
    JointBase::JointBase()
        : mManager      ( NULL )
        , mBtConstraint ( NULL )
    {
        
    }

    //---------------------------------------------------------------------
	// ● デストラクタ
    //---------------------------------------------------------------------
    JointBase::~JointBase()
    {
        if ( mManager )
        {
            if ( mBtConstraint )
            {
                mManager->getDynamicsWorld()->removeConstraint( mBtConstraint );
                SAFE_DELETE( mBtConstraint );
            }
            mManager->removeJoint( this );
            LN_SAFE_RELEASE( mManager );
        }
    }

    //---------------------------------------------------------------------
	// ● 初期化
    //---------------------------------------------------------------------
    void JointBase::initialize( Manager* manager_, btTypedConstraint* constraint_ )
    {
        mManager = manager_;
        LN_SAFE_ADDREF( mManager );
        mManager->addJoint( this );
        mBtConstraint = constraint_;
        mManager->getDynamicsWorld()->addConstraint( mBtConstraint );
    }

//-------------------------------------------------------------------------
//
//-------------------------------------------------------------------------

} // namespace Physics
} // namespace Core
} // namespace LNote

//=============================================================================
//								end of file
//=============================================================================