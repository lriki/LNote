//=============================================================================
//y BoolArray z
//-----------------------------------------------------------------------------
///**
//  @file       BoolArray.h
//  @brief      BoolArray
//  @author     Riki
//*/
//=============================================================================

#pragma once

//-------------------------------------------------------------------------
//
//-------------------------------------------------------------------------

//-------------------------------------------------------------------------
//
//-------------------------------------------------------------------------
namespace LNote
{
namespace Core
{
namespace Base
{

//=============================================================================
// ¡ BoolArray ƒNƒ‰ƒX
//-----------------------------------------------------------------------------
///**
//  @brief      Èƒƒ‚ƒŠ bool[]
//*/
//=============================================================================
class BoolArray
{
public:

	BoolArray()
		: mFlags		( NULL )
		, mArraySize	( 0 )
		, mFlagNum		( 0 )
	{}

	~BoolArray()
	{
		SAFE_DELETE_ARRAY( mFlags );
	}

public:

	/// —v‘f”‚Ì•ÏX (Å‰‚ÉŒÄ‚Ô‚±‚Æ)
	void resize( lnU32 size_ )
	{
		SAFE_DELETE_ARRAY( mFlags );

		mFlagNum = size_;
		mArraySize = mFlagNum / 32 + 1;
		mFlags = new lnU32[ mArraySize ];

		clear();
	}

    /// ’l‚ð‚·‚×‚Ä false ‚É‚·‚é
    void clear()
    {
        memset( mFlags, 0, sizeof( lnU32 ) * mArraySize );
    }

	/// Ý’è
	void set( lnU32 idx_, bool b_ )
	{
		// ( idx_ >> 5 )   ‚Í idx_ / 32
		// ( idx_ & 0x1f ) ‚Í idx_ % 32

		if ( b_ )
		{
			*( mFlags + ( idx_ >> 5 ) ) |= ( 0x01 << ( idx_ & 0x1f ) );
		}
		else
		{
			*( mFlags + ( idx_ >> 5 ) ) &= ~( 0x01 << ( idx_ & 0x1f ) );
		}
	}

	/// Žæ“¾
	bool get( lnU32 idx_ ) const
	{
		return ( ( *( mFlags + ( idx_ >> 5 ) ) ) & ( 0x01 << ( idx_ & 0x1f ) ) ) != 0;
	}

private:

	lnU32*		mFlags;
	lnU32		mArraySize;
	lnU32		mFlagNum;
};


//-------------------------------------------------------------------------
//
//-------------------------------------------------------------------------

} // namespace Base
} // namespace Core
} // namespace LNote

//=============================================================================
//								end of file
//=============================================================================