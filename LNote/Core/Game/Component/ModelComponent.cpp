//=============================================================================
//y ModelComponent z
//=============================================================================

//-------------------------------------------------------------------------
//
//-------------------------------------------------------------------------
#include "stdafx.h"
#include "../../Framework/Framework.h"
#include "../../File/Interface.h"
#include "../../File/Manager.h"
#include "../../Scene/Manager.h"
#include "ModelComponent.h"

//-------------------------------------------------------------------------
//
//-------------------------------------------------------------------------
namespace LNote
{
namespace Core
{
namespace Game
{

//=============================================================================
// ¡ ModelComponent
//=============================================================================

    //---------------------------------------------------------------------
    //
    //---------------------------------------------------------------------
    ModelComponent::ModelComponent( Manager* manager )
        : Component                 ( manager )
        , File::ASyncProcessObject  ( manager->getFramework()->getFileManager() )
        , mModel    ( NULL )
    {
    }

    //---------------------------------------------------------------------
    //
    //---------------------------------------------------------------------
    ModelComponent::~ModelComponent()
    {
        _release();
    }

    //---------------------------------------------------------------------
    //
    //---------------------------------------------------------------------
    void ModelComponent::setFileName( const lnChar* filename )
    {
        mFileName = filename;
    }

    //---------------------------------------------------------------------
    //
    //---------------------------------------------------------------------
    void ModelComponent::initialize( GameObject* object )
    {
        Component::initialize( object );

        _startLoad();
    }

    //---------------------------------------------------------------------
    //
    //---------------------------------------------------------------------
    void ModelComponent::_release()
    {
        LN_SAFE_RELEASE( mModel );
    }

    //---------------------------------------------------------------------
    //
    //---------------------------------------------------------------------
    void ModelComponent::_startLoad()
    {
        mModel = LN_NEW Scene::Model( 
            this->mManager->getFramework()->getSceneManager()->getDefaultSceneGraph());
        mModel->initialize( mFileName.c_str() );
    }

//-------------------------------------------------------------------------
//
//-------------------------------------------------------------------------

} // namespace Game
} // namespace Core
} // namespace LNote

//=============================================================================
//                              end of file
//=============================================================================